<!DOCTYPE html>
<html>
<head>
    <title>Search Snippets</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $("form").submit(function(event) {
                event.preventDefault();

                const formData = new FormData(this);
                const query = formData.get("query");

                // Search for relevant snippets
                $.ajax({
                    url: "/search",
                    type: "POST",
                    data: formData,
                    processData: false,
                    contentType: false,
                    dataType: "json", // Add this line
                    success: function(response) {
                        const snippets = response.snippets;
                        let resultsHTML = '<ol>';
                        snippets.forEach(snippet => {
                            resultsHTML += `<li>${snippet.response}</li>`;
                        });
                        resultsHTML += '</ol>';
                        $("#results").html(resultsHTML);
                    }
                });

                // Get the chatbot's response
                $.ajax({
                    url: "http://localhost:5001/api/chatbot",
                    type: "POST",
                    contentType: "application/json",
                    dataType: "json",
                    data: JSON.stringify({user_input: query}),
                    success: function(response) {
                        $("#chatbot_response").html(response.response);
                    }
                });
            });
        });
    </script>
</head>
<body>
    <h1>Search Snippets</h1>
    <form>
        <label for="query">Enter your query:</label>
        <input type="text" id="query" name="query">
        <label for="num_results">Number of results:</label>
        <select name="num_results" id="num_results">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
        <input type="submit" value="Search">
    </form>
    <div id="results"></div>
    <h2>Chatbot Response</h2>
    <div id="chatbot_response"></div>
</body>
</html>
